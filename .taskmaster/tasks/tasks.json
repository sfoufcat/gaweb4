{
  "master": {
    "tasks": [
      {
        "id": "125",
        "title": "Create CohortProgramDay TypeScript Interface",
        "description": "Add new CohortProgramDay interface and extend CohortWeekContent interface in types definition file",
        "details": "In src/types/index.ts, create CohortProgramDay interface with fields: id (string), cohortId (string), programDayId (optional string), programId (string), organizationId (string), dayIndex (number), weekId (optional string), title (optional string), summary (optional string), dailyPrompt (optional string), tasks (ProgramTaskTemplate[]), habits (optional ProgramHabitTemplate[]), courseAssignments (optional DayCourseAssignment[]), createdAt (string), updatedAt (string). Also extend existing CohortWeekContent interface to include weeklyTasks (optional ProgramTaskTemplate[]), weeklyHabits (optional ProgramHabitTemplate[]), weeklyPrompt (optional string), and distribution (optional TaskDistribution).",
        "testStrategy": "Verify TypeScript compilation passes without errors. Check that the new interface follows the same pattern as ClientProgramDay but with cohortId instead of enrollmentId. Validate that CohortWeekContent extension includes all required weekly fields.",
        "priority": "high",
        "dependencies": [],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T13:54:31.499Z"
      },
      {
        "id": "126",
        "title": "Create Cohort Days API Endpoints (List/Create)",
        "description": "Implement new API route for listing and creating cohort program days",
        "details": "Create src/app/api/coach/org-programs/[programId]/cohort-days/route.ts with GET and POST handlers. GET should filter by cohortId query parameter and return cohort days for the specified program+cohort. POST should create or update (upsert) a cohort day based on cohortId + dayIndex combination. Use Firestore collection 'cohort_program_days'. Include proper error handling, authentication checks, and validation of required fields. Follow existing API patterns from client-days endpoints.",
        "testStrategy": "Test GET endpoint returns correct cohort days filtered by cohortId. Test POST endpoint creates new cohort days and updates existing ones. Verify proper error responses for invalid data. Test authentication and authorization.",
        "priority": "high",
        "dependencies": [
          "125"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T13:55:58.120Z"
      },
      {
        "id": "127",
        "title": "Create Single Cohort Day API Endpoint (Get/Update/Delete)",
        "description": "Implement API route for individual cohort day operations",
        "details": "Create src/app/api/coach/org-programs/[programId]/cohort-days/[cohortDayId]/route.ts with GET, PATCH, and DELETE handlers. GET retrieves single cohort day by ID. PATCH updates specific fields of a cohort day. DELETE removes the cohort day document. Include validation, error handling, and proper HTTP status codes. Follow RESTful conventions and existing API patterns.",
        "testStrategy": "Test GET returns correct cohort day by ID. Test PATCH updates only specified fields. Test DELETE removes document from Firestore. Verify 404 responses for non-existent IDs. Test validation of update data.",
        "priority": "high",
        "dependencies": [
          "125"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T13:57:24.587Z"
      },
      {
        "id": "128",
        "title": "Update Cohort Week Content API",
        "description": "Extend existing cohort week content API to handle weekly tasks and distribution",
        "details": "Modify src/app/api/coach/org-programs/[programId]/cohorts/[cohortId]/week-content/[weekId]/route.ts to accept new fields: weeklyTasks, weeklyHabits, weeklyPrompt, and distribution. Ensure each task gets a unique programTaskId if not provided. Add support for distributeTasksNow flag that triggers immediate distribution of weekly tasks to days. Maintain backward compatibility with existing week content structure.",
        "testStrategy": "Test API accepts and saves new weekly fields. Verify programTaskId generation for tasks without IDs. Test distributeTasksNow flag triggers distribution. Ensure existing week content functionality remains intact.",
        "priority": "high",
        "dependencies": [
          "125"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T13:59:26.406Z"
      },
      {
        "id": "129",
        "title": "Create distributeCohortWeeklyTasksToDays Function",
        "description": "Implement task distribution logic for cohort weekly tasks",
        "details": "Add distributeCohortWeeklyTasksToDays function in src/lib/program-utils.ts. Function should: 1) Fetch week data to get startDayIndex and endDayIndex, 2) Fetch cohort week content including weeklyTasks and distribution settings, 3) Apply distribution logic (repeat-daily copies tasks to each day, spread distributes tasks across days), 4) Create or update cohort_program_days documents in Firestore, 5) Return object with counts: {created, updated, skipped}. Use existing distributeWeeklyTasksToDays as reference but target cohort_program_days collection.",
        "testStrategy": "Test function correctly distributes tasks based on repeat-daily vs spread distribution. Verify correct dayIndex calculations. Test creation and updating of cohort_program_days documents. Validate return counts match actual operations performed.",
        "priority": "medium",
        "dependencies": [
          "125",
          "126"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T14:00:15.900Z"
      },
      {
        "id": "130",
        "title": "Add Cohort Branch in handleSaveDay Function",
        "description": "Update day save logic to detect cohort mode and save to appropriate endpoint",
        "details": "In src/components/coach/programs/CoachProgramsTab.tsx, modify handleSaveDay function to include cohort detection logic. Add conditional branch: if isClientMode -> save to client-days endpoint, else if isCohortMode -> save to cohort-days endpoint, else save to template days endpoint. Determine cohort mode by checking if selectedCohort exists and is not null. Use the new cohort-days API endpoints created in previous tasks.",
        "testStrategy": "Test day saves go to correct endpoint based on mode. Verify isClientMode takes precedence over isCohortMode. Test template mode works when no cohort is selected. Validate proper error handling for each save path.",
        "priority": "medium",
        "dependencies": [
          "126",
          "127"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T14:03:24.882Z"
      },
      {
        "id": "131",
        "title": "Add Cohort Branch in Week Save Logic",
        "description": "Update week save callback to handle cohort-specific week content",
        "details": "In src/components/coach/programs/CoachProgramsTab.tsx, update the week onSave callback to detect cohort mode and save cohort-specific week content. When in cohort mode (selectedCohort exists), call the cohort week-content API with the new weekly fields (weeklyTasks, weeklyHabits, weeklyPrompt, distribution). Include logic to handle distributeTasksNow flag if user requests immediate distribution.",
        "testStrategy": "Test week saves include weekly task fields when in cohort mode. Verify distribution flag triggers task distribution. Test fallback to template week save when not in cohort mode. Validate proper error handling and user feedback.",
        "priority": "medium",
        "dependencies": [
          "128"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T14:04:49.601Z"
      },
      {
        "id": "132",
        "title": "Update Sync Logic to Read Cohort Days",
        "description": "Modify program sync engine to prioritize cohort-specific days over template days",
        "details": "In src/lib/program-engine.ts, update syncProgramTasksToClientDay function to: 1) Check if enrollment is in a group program with cohortId, 2) Query cohort_program_days collection first for the specific cohort+dayIndex combination, 3) Use cohort-specific tasks if found, otherwise fall back to template program_days, 4) Add logging to indicate source type (cohort vs template) for debugging. Maintain existing sync logic but change data source priority.",
        "testStrategy": "Test sync reads cohort days when enrollment has cohortId. Verify fallback to template days when no cohort override exists. Test logging shows correct source type. Validate sync behavior for non-cohort enrollments remains unchanged.",
        "priority": "high",
        "dependencies": [
          "125",
          "126"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T14:05:53.284Z"
      },
      {
        "id": "133",
        "title": "Update UI to Load and Display Cohort Days",
        "description": "Modify program editor UI to fetch and display cohort-specific days when in cohort mode",
        "details": "In src/components/coach/programs/CoachProgramsTab.tsx, add logic to: 1) Fetch cohort-specific days when selectedCohort exists, 2) Merge cohort days with template days (cohort overrides template for same dayIndex), 3) Display merged days in the program editor, 4) Show visual indicators when viewing cohort-specific content vs template. Update data loading hooks and state management to handle cohort days alongside template days.",
        "testStrategy": "Test UI loads cohort days when cohort is selected. Verify merge logic prioritizes cohort overrides. Test visual indicators show cohort vs template content. Validate performance with large numbers of days.",
        "priority": "medium",
        "dependencies": [
          "126",
          "127"
        ],
        "status": "pending",
        "subtasks": []
      },
      {
        "id": "134",
        "title": "Integration Testing and Acceptance Criteria Validation",
        "description": "Comprehensive testing of cohort task persistence and distribution workflow",
        "details": "Execute full integration testing covering all acceptance criteria: 1) Test cohort day task persistence (add task to cohort day, verify it persists and doesn't affect template), 2) Test cohort week task distribution (add weekly tasks, verify distribution to individual days), 3) Test cohort sync to members (enroll user, trigger sync, verify daily focus shows cohort tasks), 4) Test template baseline functionality (verify template editing still works for cohorts without overrides). Include end-to-end testing of the complete workflow from task creation to user sync.",
        "testStrategy": "Execute all acceptance criteria test cases. Verify no regression in existing functionality. Test edge cases like empty cohorts, missing templates, and concurrent edits. Validate performance impact and error handling across the entire workflow.",
        "priority": "high",
        "dependencies": [
          "129",
          "130",
          "131",
          "132",
          "133"
        ],
        "status": "done",
        "subtasks": [],
        "updatedAt": "2026-01-08T14:12:18.981Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-08T14:12:18.981Z",
      "taskCount": 10,
      "completedCount": 9,
      "tags": [
        "master"
      ]
    }
  }
}